
/*
* Se realiza la creación de características para asociar a un punto o servicio al portal 3dEYE tomando como base el plan Netlifecam.
* @author Marlon Plúas <mpluas@telconet.ec>
* @version 1.0 18-11-2019
*/

UPDATE
	DB_COMERCIAL.ADMI_PRODUCTO
SET
	ESTADO = 'Activo'
	WHERE NOMBRE_TECNICO = 'CAMARA IP';

UPDATE
	DB_COMERCIAL.INFO_PLAN_DET
SET
	ESTADO = 'Activo'
WHERE
	PRODUCTO_ID = (
	SELECT
		ID_PRODUCTO
	FROM
		DB_COMERCIAL.ADMI_PRODUCTO
	WHERE
		NOMBRE_TECNICO = 'CAMARA IP');

INSERT
INTO DB_COMERCIAL.ADMI_CARACTERISTICA
  (
    ID_CARACTERISTICA,
    DESCRIPCION_CARACTERISTICA,
    TIPO_INGRESO,
    ESTADO,
    FE_CREACION,
    USR_CREACION,
    FE_ULT_MOD,
    USR_ULT_MOD,
    TIPO
  )
  VALUES
  (
    DB_COMERCIAL.SEQ_ADMI_CARACTERISTICA.NEXTVAL,
    'USER 3DEYE',
    'N',
    'Activo',
    SYSDATE,
    'mpluas',
    NULL,
    NULL,
    'COMERCIAL'
  );
 
INSERT
INTO DB_COMERCIAL.ADMI_CARACTERISTICA
  (
    ID_CARACTERISTICA,
    DESCRIPCION_CARACTERISTICA,
    TIPO_INGRESO,
    ESTADO,
    FE_CREACION,
    USR_CREACION,
    FE_ULT_MOD,
    USR_ULT_MOD,
    TIPO
  )
  VALUES
  (
    DB_COMERCIAL.SEQ_ADMI_CARACTERISTICA.NEXTVAL,
    'ROL 3DEYE',
    'N',
    'Activo',
    SYSDATE,
    'mpluas',
    NULL,
    NULL,
    'COMERCIAL'
  );
 
INSERT
INTO DB_COMERCIAL.ADMI_PRODUCTO_CARACTERISTICA
  (
    ID_PRODUCTO_CARACTERISITICA,
    PRODUCTO_ID,
    CARACTERISTICA_ID,
    FE_CREACION,
    FE_ULT_MOD,
    USR_CREACION,
    USR_ULT_MOD,
    ESTADO,
    VISIBLE_COMERCIAL
  )	
  VALUES
  (
    DB_COMERCIAL.SEQ_ADMI_PRODUCTO_CARAC.NEXTVAL,
    (
     SELECT ID_PRODUCTO 
     FROM DB_COMERCIAL.ADMI_PRODUCTO 
     WHERE NOMBRE_TECNICO = 'CAMARA IP'
     AND ESTADO = 'Activo'
    ),
    (
     SELECT ID_CARACTERISTICA 
     FROM DB_COMERCIAL.ADMI_CARACTERISTICA 
     WHERE DESCRIPCION_CARACTERISTICA = 'USER 3DEYE'
     AND ESTADO = 'Activo'
    ),
    SYSDATE,
    NULL,
    'mpluas',
    NULL,
    'Activo',
    'SI'
  );
 
INSERT
INTO DB_COMERCIAL.ADMI_PRODUCTO_CARACTERISTICA
  (
    ID_PRODUCTO_CARACTERISITICA,
    PRODUCTO_ID,
    CARACTERISTICA_ID,
    FE_CREACION,
    FE_ULT_MOD,
    USR_CREACION,
    USR_ULT_MOD,
    ESTADO,
    VISIBLE_COMERCIAL
  )	
  VALUES
  (
    DB_COMERCIAL.SEQ_ADMI_PRODUCTO_CARAC.NEXTVAL,
    (
     SELECT ID_PRODUCTO 
     FROM DB_COMERCIAL.ADMI_PRODUCTO 
     WHERE NOMBRE_TECNICO = 'CAMARA IP'
     AND ESTADO = 'Activo'
    ),
    (
     SELECT ID_CARACTERISTICA 
     FROM DB_COMERCIAL.ADMI_CARACTERISTICA 
     WHERE DESCRIPCION_CARACTERISTICA = 'ROL 3DEYE'
     AND ESTADO = 'Activo'
    ),
    SYSDATE,
    NULL,
    'mpluas',
    NULL,
    'Activo',
    'SI'
  );

UPDATE
	DB_COMERCIAL.INFO_PLAN_DET
SET
	ESTADO = 'Inactivo'
WHERE
	PRODUCTO_ID != (
	SELECT
		ID_PRODUCTO
	FROM
		DB_COMERCIAL.ADMI_PRODUCTO
	WHERE
		NOMBRE_TECNICO = 'CAMARA IP')
	AND PLAN_ID = (
	SELECT
		ID_PLAN
	FROM
		DB_COMERCIAL.INFO_PLAN_CAB
	WHERE
		NOMBRE_PLAN = 'Netlifecam ST'
		AND ESTADO = 'Activo')
	AND ESTADO = 'Activo';
  
COMMIT;

/

