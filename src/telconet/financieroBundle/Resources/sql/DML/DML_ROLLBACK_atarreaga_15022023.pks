/** 
 * @author Alex Arreaga <atarreaga@telconet.ec>
 * @version 1.0 
 * @since 15-02-2023
 * Se crea DML para reverso de configuraciones Ecuanet.
 */

---DB_FINANCIERO---

--ADMI_PARAMETRO_DET
Delete from DB_GENERAL.ADMI_PARAMETRO_DET WHERE EMPRESA_COD = '33' AND PARAMETRO_ID IN (SELECT ID_PARAMETRO FROM DB_GENERAL.ADMI_PARAMETRO_CAB WHERE NOMBRE_PARAMETRO = 'OBSERVACION_FACTURA_MANUAL') AND USR_CREACION = 'atarreaga';

Delete from DB_GENERAL.ADMI_PARAMETRO_DET WHERE EMPRESA_COD = '33' AND PARAMETRO_ID IN (SELECT ID_PARAMETRO FROM DB_GENERAL.ADMI_PARAMETRO_CAB WHERE NOMBRE_PARAMETRO = 'OPCIONES_HABILITADAS_FINANCIERO') AND USR_CREACION = 'atarreaga';

Delete from DB_GENERAL.ADMI_PARAMETRO_DET WHERE EMPRESA_COD = '33' AND PARAMETRO_ID IN (SELECT ID_PARAMETRO FROM DB_GENERAL.ADMI_PARAMETRO_CAB WHERE NOMBRE_PARAMETRO = 'PERIODO_FACTURACION') AND USR_CREACION = 'atarreaga';

Delete from DB_GENERAL.ADMI_PARAMETRO_DET WHERE EMPRESA_COD = '33' AND PARAMETRO_ID IN (SELECT ID_PARAMETRO FROM DB_GENERAL.ADMI_PARAMETRO_CAB WHERE NOMBRE_PARAMETRO = 'SECUENCIALES_POR_EMPRESA') AND USR_CREACION = 'atarreaga';


---DB_COMPROBANTES---

--ADMI_EMPRESA

Delete from  DB_COMPROBANTES.ADMI_EMPRESA_NOTICIA where EMPRESA_ID IN (SELECT ID_EMPRESA FROM DB_COMPROBANTES.ADMI_EMPRESA WHERE CODIGO = 'EN') AND USR_CREACION = 'atarreaga';

Delete from DB_COMPROBANTES.ADMI_EMPRESA_PARAMETRO where EMPRESA_ID IN (SELECT ID_EMPRESA FROM DB_COMPROBANTES.ADMI_EMPRESA WHERE CODIGO = 'EN') AND USR_CREACION = 'atarreaga';

Delete from DB_COMPROBANTES.ADMI_PARAMETRO_DET WHERE EMPRESA_ID IN (SELECT ID_EMPRESA FROM DB_COMPROBANTES.ADMI_EMPRESA WHERE CODIGO = 'EN') AND USR_CREACION = 'atarreaga';

Delete from DB_COMPROBANTES.ADMI_USUARIO_EMPRESA WHERE USUARIO_ID IN (SELECT ID_USUARIO FROM DB_COMPROBANTES.ADMI_USUARIO WHERE LOGIN = 'ecuanet') AND EMPRESA_ID IN (SELECT ID_EMPRESA FROM DB_COMPROBANTES.ADMI_EMPRESA WHERE CODIGO = 'EN') AND USR_CREACION = 'atarreaga';

Delete from DB_COMPROBANTES.INFO_CAMPO_ADICIONAL WHERE EMPRESA_ID IN (SELECT ID_EMPRESA FROM DB_COMPROBANTES.ADMI_EMPRESA WHERE CODIGO = 'EN') AND USR_CREACION = 'atarreaga';

Delete from DB_COMPROBANTES.INFO_CERTIFICADO WHERE EMPRESA_ID IN (SELECT ID_EMPRESA FROM DB_COMPROBANTES.ADMI_EMPRESA WHERE CODIGO = 'EN') AND USR_CREACION = 'atarreaga';

Delete from DB_COMPROBANTES.INFO_NOTIF_PLANTILLA WHERE PADRE_ID IN (SELECT ID_NOTIFICACION FROM DB_COMPROBANTES.INFO_NOTIFICACION WHERE MARCA = 'ECUANET') AND TIPO_DOC_CODIGO IN ('04','01') AND USR_CREACION = 'atarreaga';

Delete from DB_COMPROBANTES.INFO_NOTIFICACION WHERE EMPRESA_ID IN (SELECT ID_EMPRESA FROM DB_COMPROBANTES.ADMI_EMPRESA WHERE CODIGO = 'EN') AND USR_CREACION = 'atarreaga';

Delete from DB_COMPROBANTES.ADMI_USUARIO WHERE LOGIN = 'ecuanet' AND USR_CREACION = 'atarreaga';

Delete from DB_COMPROBANTES.ADMI_EMPRESA where CODIGO = 'EN' AND USR_CREACION = 'atarreaga';


---DB_GENERAL---

--DB_GENERAL.ADMI_GESTION_DIRECTORIOS 
Delete from DB_GENERAL.ADMI_GESTION_DIRECTORIOS WHERE EMPRESA = 'EN' AND CODIGO_APP = 5 AND APLICACION = 'ComprobantesElectronicos' AND MODULO = 'EnvioDocumentos' AND USR_CREACION = 'atarreaga';

--
--reverso de numeracion facturas oficina ecuanet guayaquil

UPDATE DB_comercial.admi_numeracion
set numeracion_uno = '013',
numeracion_dos = '002'
where codigo = 'FACE'
and oficina_id = (select ID_OFICINA from DB_COMERCIAL.INFO_OFICINA_GRUPO 
WHERE NOMBRE_OFICINA='ECUANET - GUAYAQUIL' AND ESTADO='Activo' AND EMPRESA_ID=33);

--reverso de numeracion facturas oficina ecuanet quito

UPDATE DB_comercial.admi_numeracion
set numeracion_uno = '001',
numeracion_dos = '011'
where codigo = 'FACE'
and oficina_id = (select ID_OFICINA from DB_COMERCIAL.INFO_OFICINA_GRUPO 
WHERE NOMBRE_OFICINA='ECUANET - QUITO' AND ESTADO='Activo' AND EMPRESA_ID=33);

--reverso de numeracion Notas de credito

UPDATE DB_comercial.admi_numeracion
set numeracion_uno = '001',
numeracion_dos = '011'
where codigo = 'NCE'
and oficina_id = (select ID_OFICINA from DB_COMERCIAL.INFO_OFICINA_GRUPO 
WHERE NOMBRE_OFICINA='ECUANET - QUITO' AND ESTADO='Activo' AND EMPRESA_ID=33);


COMMIT;
/
